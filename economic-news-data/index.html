<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Economic News Headlines Tracker</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 1200px; margin: 0 auto; padding: 20px; }
        .header { text-align: center; margin-bottom: 30px; }
        .summary { background: #f5f5f5; padding: 20px; border-radius: 8px; margin-bottom: 30px; }
        
        /* Updated grid for exactly 4 columns */
        .categories { 
            display: grid; 
            grid-template-columns: repeat(4, 1fr); 
            gap: 15px; 
        }
        
        /* Responsive: 2 columns on tablets, 1 on mobile */
        @media (max-width: 768px) {
            .categories { grid-template-columns: repeat(2, 1fr); }
        }
        @media (max-width: 480px) {
            .categories { grid-template-columns: 1fr; }
        }
        
        .category { background: white; padding: 15px; border-radius: 8px; border: 1px solid #ddd; }
        .number { font-size: 24px; font-weight: bold; color: #2563eb; }
        .last-updated { color: #666; font-size: 14px; }
        .sources-organized { margin-top: 10px; }
        .sources-organized strong { color: #333; }
        
        /* Sample headlines styling */
        .sample-headlines { 
            background: white; 
            padding: 20px; 
            border-radius: 8px; 
            margin-top: 20px; 
            border: 1px solid #ddd; 
        }
        .headline-item { 
            padding: 10px 0; 
            border-bottom: 1px solid #eee; 
        }
        .headline-item:last-child { 
            border-bottom: none; 
        }
        .headline-title { 
            font-weight: bold; 
            color: #333; 
            margin-bottom: 5px; 
        }
        .headline-title a { 
            color: #2563eb; 
            text-decoration: none; 
        }
        .headline-title a:hover { 
            text-decoration: underline; 
        }
        .headline-meta { 
            font-size: 12px; 
            color: #666; 
        }
        
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { padding: 8px; text-align: left; border-bottom: 1px solid #ddd; }
        th { background-color: #f8f9fa; }
    </style>
</head>
<body>
    <div class="header">
        <h1>Economic News Data</h1>
        <p>Automated tracking of economic keywords in major news outlets</p>
    </div>

    <div class="summary" id="summary">
        <h2>Latest Data</h2>
        <div id="loading">Loading data...</div>
    </div>

    <div class="sample-headlines" id="sample-headlines-container" style="display: none;">
        <h2>Sample Headlines from Latest Data</h2>
        <div id="sample-headlines"></div>
    </div>

    <div id="categories-container">
        <h2>Categories</h2>
        <div class="categories" id="categories"></div>
    </div>

    <script>
        async function loadData() {
            try {
                const response = await fetch('summary.json');
                const data = await response.json();
                
                // Use organized sources if available, fallback to original
                const sourcesToDisplay = data.latest_scrape.sources_organized || data.latest_scrape.sources_scraped;
                const sourcesText = Array.isArray(sourcesToDisplay) ? sourcesToDisplay.join(', ') : sourcesToDisplay;
                
                // Update summary
                const summaryDiv = document.getElementById('summary');
                summaryDiv.innerHTML = `
                    <h2>Latest Data</h2>
                    <p><strong>Last Scrape:</strong> ${data.latest_scrape.date}</p>
                    <p><strong>Headlines Collected:</strong> ${data.latest_scrape.total_headlines}</p>
                    <div class="sources-organized">
                        <strong>Sources:</strong> ${sourcesText}
                    </div>
                    <p><strong>Relevance Score:</strong> ${data.latest_scrape.relevance_score.toFixed(3)}</p>
                    <p><strong>Total Days Tracked:</strong> ${data.total_days}</p>
                    <p class="last-updated">Data updated: ${new Date(data.last_updated).toLocaleString()}</p>
                `;
                
                // Update categories
                const categoriesDiv = document.getElementById('categories');
                categoriesDiv.innerHTML = '';
                
                Object.entries(data.categories).forEach(([name, stats]) => {
                    const categoryDiv = document.createElement('div');
                    categoryDiv.className = 'category';
                    categoryDiv.innerHTML = `
                        <h3>${name.replace(/_/g, ' ').replace(/\b\w/g, l => l.toUpperCase())}</h3>
                        <div class="number">${stats.latest}</div>
                        <small>Latest count</small><br>
                        <small>Avg: ${stats.average.toFixed(1)} | Total: ${stats.total}</small>
                    `;
                    categoriesDiv.appendChild(categoryDiv);
                });
                
                // Display sample headlines if available
                if (data.latest_scrape.sample_headlines && data.latest_scrape.sample_headlines.length > 0) {
                    const sampleHeadlinesContainer = document.getElementById('sample-headlines-container');
                    const sampleHeadlinesDiv = document.getElementById('sample-headlines');
                    
                    sampleHeadlinesDiv.innerHTML = '';
                    
                    data.latest_scrape.sample_headlines.forEach((headline, index) => {
                        const headlineDiv = document.createElement('div');
                        headlineDiv.className = 'headline-item';
                        
                        const titleElement = headline.link ? 
                            `<a href="${headline.link}" target="_blank">${headline.title}</a>` : 
                            headline.title;
                        
                        headlineDiv.innerHTML = `
                            <div class="headline-title">${index + 1}. ${titleElement}</div>
                            <div class="headline-meta">
                                Source: ${headline.source}
                                ${headline.published_at ? ` | Published: ${new Date(headline.published_at).toLocaleString()}` : ''}
                            </div>
                        `;
                        sampleHeadlinesDiv.appendChild(headlineDiv);
                    });
                    
                    sampleHeadlinesContainer.style.display = 'block';
                }
                
            } catch (error) {
                document.getElementById('loading').innerHTML = 'Error loading data: ' + error.message;
            }
        }
        
        loadData();
    </script>
</body>
</html>
